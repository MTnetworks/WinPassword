# 云存储同步功能指南

## 📋 功能概述

云存储同步功能允许您将密码数据库自动同步到云存储服务，实现多设备间的数据同步和备份。支持多种云存储服务和网络驱动器。

### 🌟 主要特性

- **多平台支持**：支持百度网盘、OneDrive、Dropbox等主流云存储服务
- **网络驱动器**：支持局域网共享文件夹和网络映射驱动器
- **自动同步**：可设置定时自动同步，无需手动操作
- **冲突解决**：智能处理同步冲突，支持多种解决策略
- **安全可靠**：所有同步操作都保持数据加密，确保安全性
- **实时状态**：界面实时显示同步状态和最后同步时间

## 🚀 快速开始

### 第一步：启用云存储功能

1. 在主界面点击菜单栏"设置" → "云存储设置"
2. 在"基本设置"标签页中勾选"启用云存储同步"
3. 选择您要使用的存储类型

### 第二步：配置存储路径

根据您选择的存储类型配置相应路径：

#### 百度网盘
- 确保已安装百度网盘客户端并完成同步设置
- 在"远程路径"中输入百度网盘本地同步文件夹路径
- 例如：`C:\Users\用户名\百度网盘\密码管理器`

#### OneDrive
- 确保已安装OneDrive客户端并完成同步设置
- 在"远程路径"中输入OneDrive本地同步文件夹路径
- 例如：`C:\Users\用户名\OneDrive\密码管理器`

#### Dropbox
- 确保已安装Dropbox客户端并完成同步设置
- 在"远程路径"中输入Dropbox本地同步文件夹路径
- 例如：`C:\Users\用户名\Dropbox\密码管理器`

#### 网络驱动器
- 映射网络驱动器到本地（如Z:盘）
- 在"网络驱动器路径"中输入映射的驱动器路径
- 例如：`Z:\共享文件夹\密码管理器`

### 第三步：初始同步设置

1. **首次使用**：
   - 如果云端没有数据库文件，程序会自动上传当前数据库
   - 如果云端已有数据库文件，程序会询问是否下载覆盖本地文件

2. **配置本地缓存路径**（可选）：
   - 设置本地缓存目录，用于临时存储同步文件
   - 默认使用系统临时目录

## ⚙️ 详细配置

### 基本设置

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| 启用云存储同步 | 是否启用云存储功能 | 关闭 |
| 存储类型 | 选择云存储服务类型 | 本地存储 |
| 远程路径 | 云存储本地同步文件夹路径 | 空 |
| 本地缓存路径 | 本地缓存目录 | 系统临时目录 |

### 高级设置

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| 保存时同步 | 保存密码后自动同步到云端 | 启用 |
| 打开时同步 | 打开程序时自动从云端同步 | 启用 |
| 自动同步间隔 | 定时自动同步的时间间隔（秒） | 300秒 |
| 冲突解决策略 | 当本地和云端文件都有更新时的处理方式 | 使用较新文件 |
| 启用同步 | 是否启用自动同步功能 | 启用 |

### 冲突解决策略

- **使用较新文件**：比较文件修改时间，使用较新的文件
- **优先本地文件**：发生冲突时总是使用本地文件
- **优先远程文件**：发生冲突时总是使用云端文件
- **每次询问**：发生冲突时弹出对话框让用户选择

## 🔄 同步操作

### 自动同步

启用自动同步后，程序会在以下情况自动执行同步：

1. **程序启动时**：从云端下载最新数据（如果启用"打开时同步"）
2. **保存数据时**：上传到云端（如果启用"保存时同步"）
3. **定时同步**：按设定间隔自动执行双向同步

### 手动同步

在云存储设置对话框的"同步状态"标签页中，您可以：

- **从远程同步**：从云端下载最新数据到本地
- **同步到远程**：将本地数据上传到云端
- **手动完整同步**：执行完整的双向同步

### 同步状态监控

- **主界面状态栏**：显示当前同步状态和最后同步时间
- **设置对话框**：显示详细的同步状态信息
- **状态指示**：
  - 🟢 绿色：同步成功
  - 🟡 橙色：正在同步
  - 🔴 红色：同步失败
  - ⚪ 灰色：未启用或未同步

## 📱 多设备使用场景

### 场景一：家庭和办公室电脑同步

1. **设置A电脑**：
   - 配置云存储同步到百度网盘
   - 启用自动同步功能

2. **设置B电脑**：
   - 安装相同的密码管理工具
   - 配置相同的云存储路径
   - 首次启动时选择从云端下载数据库

3. **日常使用**：
   - 在任一电脑上修改密码后会自动同步
   - 另一台电脑启动时会自动获取最新数据

### 场景二：团队共享密码库

1. **管理员设置**：
   - 创建共享网络驱动器
   - 配置密码管理工具使用网络驱动器
   - 设置适当的访问权限

2. **团队成员**：
   - 映射相同的网络驱动器
   - 配置密码管理工具使用网络路径
   - 设置冲突解决策略为"每次询问"

### 场景三：移动办公

1. **主要设备**：
   - 配置OneDrive或Dropbox同步
   - 启用所有自动同步选项

2. **临时设备**：
   - 快速配置云存储同步
   - 使用完毕后可选择清除本地缓存

## 🛠️ 故障排除

### 常见问题

#### 1. 同步状态显示"未初始化"

**原因**：云存储功能未正确初始化

**解决方法**：
1. 检查云存储设置是否正确配置
2. 确认远程路径是否存在且可访问
3. 重新保存云存储设置
4. 重启应用程序

#### 2. 同步失败

**可能原因**：
- 网络连接问题
- 云存储客户端未运行
- 路径权限问题
- 磁盘空间不足

**解决方法**：
1. 检查网络连接
2. 确认云存储客户端正常运行
3. 检查路径权限和磁盘空间
4. 在设置中点击"测试连接"

#### 3. 冲突频繁发生

**原因**：多设备同时修改数据

**解决方法**：
1. 调整自动同步间隔
2. 使用"每次询问"冲突解决策略
3. 建立团队使用规范

#### 4. 同步速度慢

**可能原因**：
- 网络带宽限制
- 云存储客户端限速
- 数据库文件过大

**解决方法**：
1. 检查网络带宽
2. 调整云存储客户端设置
3. 定期清理不需要的密码数据

### 高级故障排除

#### 检查配置文件

配置文件位置：`~/.passwordmanager/config.json`

```json
{
  "cloud_storage": {
    "enabled": true,
    "type": "baidu_netdisk",
    "remote_path": "C:\\Users\\用户名\\百度网盘\\密码管理器",
    "local_cache_path": "",
    "sync_on_save": true,
    "sync_on_open": true,
    "auto_sync_interval": 300,
    "conflict_resolution": "newer",
    "sync_enabled": true
  }
}
```

#### 手动重置配置

如果遇到严重配置问题，可以手动重置：

1. 关闭程序
2. 删除配置文件中的 `cloud_storage` 部分
3. 重新启动程序并重新配置

## 🔒 安全注意事项

### 数据安全

1. **加密保护**：
   - 数据库文件本身已加密，云端存储的也是加密文件
   - 即使云存储账号被盗，数据仍然安全

2. **访问控制**：
   - 确保云存储账号使用强密码和双因素认证
   - 定期检查云存储的访问日志

3. **网络安全**：
   - 使用可信的网络连接
   - 避免在公共WiFi下进行同步操作

### 隐私保护

1. **路径选择**：
   - 选择私有的云存储文件夹
   - 避免使用共享文件夹存储敏感数据

2. **缓存清理**：
   - 定期清理本地缓存文件
   - 在共享电脑上使用后清除痕迹

## 📞 技术支持

### 获取帮助

1. **查看日志**：程序运行时的详细日志可以帮助诊断问题
2. **测试连接**：使用设置中的"测试连接"功能验证配置
3. **重新配置**：如果问题持续，尝试重新配置云存储设置

### 反馈问题

如果遇到问题，请提供以下信息：
- 操作系统版本
- 云存储服务类型
- 错误信息截图
- 配置文件内容（隐藏敏感信息）

---

**💡 提示**：云存储同步功能需要稳定的网络连接和正确配置的云存储客户端。建议在配置完成后进行充分测试，确保同步功能正常工作。